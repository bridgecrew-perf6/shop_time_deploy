{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Redirect}from'react-router-dom';import{connect}from'react-redux';import{get_product,get_related_products}from'../actions/products';import{add_item,get_items,get_total,get_item_total}from'../actions/cart';import{get_wishlist_items,get_wishlist_item_total,add_wishlist_item,remove_wishlist_item}from'../actions/wishlist';import{get_reviews,get_review,create_review,update_review,delete_review,filter_reviews}from'../actions/reviews';import Card from'../components/Card';import ProductDetailCard from'../components/ProductDetailCard';import LeaveReview from'../components/LeaveReview';import Reviews from'../components/Reviews';import Stars from'../components/Stars';var ProductDetail=function ProductDetail(_ref){var match=_ref.match,product=_ref.product,get_product=_ref.get_product,related_products=_ref.related_products,get_related_products=_ref.get_related_products,add_item=_ref.add_item,get_items=_ref.get_items,get_total=_ref.get_total,get_item_total=_ref.get_item_total,wishlist=_ref.wishlist,get_wishlist_items=_ref.get_wishlist_items,get_wishlist_item_total=_ref.get_wishlist_item_total,add_wishlist_item=_ref.add_wishlist_item,remove_wishlist_item=_ref.remove_wishlist_item,isAuthenticated=_ref.isAuthenticated,review=_ref.review,reviews=_ref.reviews,get_reviews=_ref.get_reviews,get_review=_ref.get_review,create_review=_ref.create_review,update_review=_ref.update_review,delete_review=_ref.delete_review,filter_reviews=_ref.filter_reviews;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loginRedirect=_useState2[0],setLoginRedirect=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),redirect=_useState4[0],setRedirect=_useState4[1];var _useState5=useState({comment:''}),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];var _useState7=useState(5.0),_useState8=_slicedToArray(_useState7,2),rating=_useState8[0],setRating=_useState8[1];var comment=formData.comment;useEffect(function(){if(isAuthenticated!==null&&isAuthenticated!==undefined){if(isAuthenticated&&review&&review!==null&&review!==undefined&&review.comment&&review.comment!==null&&review.comment!==undefined){setFormData({comment:review.comment});}else{setFormData({comment:''});}}},[review,isAuthenticated]);useEffect(function(){window.scrollTo(0,0);var productId=match.params.id;get_product(productId);get_related_products(productId);},[match.params.id]);useEffect(function(){var productId=match.params.id;get_reviews(productId);},[match.params.id]);useEffect(function(){var productId=match.params.id;get_review(productId);},[match.params.id,isAuthenticated]);var onChange=function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},e.target.name,e.target.value)));};var requireLogin=function requireLogin(e){e.preventDefault();setLoginRedirect(true);};var leaveReview=function leaveReview(e){e.preventDefault();var productId=match.params.id;if(rating!==null)create_review(productId,rating,comment);};var updateReview=function updateReview(e){e.preventDefault();var productId=match.params.id;if(rating!==null)update_review(productId,rating,comment);};var deleteReview=function deleteReview(){var productId=match.params.id;var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return delete_review(productId);case 2:_context.next=4;return get_review(productId);case 4:setRating(5.0);setFormData({comment:''});case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();};var filterReviews=function filterReviews(numStars){var productId=match.params.id;filter_reviews(productId,numStars);};var getReviews=function getReviews(){var productId=match.params.id;get_reviews(productId);};var getRelatedProducts=function getRelatedProducts(){if(related_products&&related_products!==null&&related_products!==undefined&&related_products.length!==0){return related_products.map(function(product,index){return/*#__PURE__*/_jsx(\"div\",{className:\"col-4\",children:/*#__PURE__*/_jsx(Card,{product:product,add_item:add_item,get_items:get_items,get_total:get_total,get_item_total:get_item_total,wishlist:wishlist,get_wishlist_items:get_wishlist_items,get_wishlist_item_total:get_wishlist_item_total,add_wishlist_item:add_wishlist_item,remove_wishlist_item:remove_wishlist_item,isAuthenticated:isAuthenticated,setLoginRedirect:setLoginRedirect,setRedirect:setRedirect})},index);});}};var getLeaveReviewComponent=function getLeaveReviewComponent(){if(isAuthenticated){if(review&&review!==null&&review!==undefined&&Object.keys(review).length===0){return/*#__PURE__*/_jsx(LeaveReview,{review:review,rating:rating,setRating:setRating,onSubmit:leaveReview,onChange:onChange,comment:comment});}else if(review&&review!==null&&review!==undefined&&Object.keys(review).length!==0){return/*#__PURE__*/_jsx(LeaveReview,{review:review,rating:rating,setRating:setRating,onSubmit:updateReview,onChange:onChange,comment:comment,deleteReview:deleteReview});}}else{return/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-warning\",onClick:requireLogin,children:\"Login to Leave a Review\"});}};if(loginRedirect)return/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});if(redirect)return/*#__PURE__*/_jsx(Redirect,{to:\"/cart-or-continue-shopping\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-5\",children:[/*#__PURE__*/_jsx(ProductDetailCard,{product:product,add_item:add_item,get_items:get_items,get_total:get_total,get_item_total:get_item_total,setRedirect:setRedirect,isAuthenticated:isAuthenticated,setLoginRedirect:setLoginRedirect,add_wishlist_item:add_wishlist_item,get_wishlist_items:get_wishlist_items,get_wishlist_item_total:get_wishlist_item_total}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"section\",{className:\"mt-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mt-5\",children:\"Related Products:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5 ml-5 mr-5\",children:getRelatedProducts()})]}),/*#__PURE__*/_jsx(\"section\",{className:\"mt-5 mb-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-3\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-3\",children:\"Filter Reviews\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-sm mb-3\",onClick:getReviews,children:\"All\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",style:{cursor:'pointer'},onClick:function onClick(){return filterReviews(5);},children:/*#__PURE__*/_jsx(Stars,{rating:5.0})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",style:{cursor:'pointer'},onClick:function onClick(){return filterReviews(4);},children:/*#__PURE__*/_jsx(Stars,{rating:4.0})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",style:{cursor:'pointer'},onClick:function onClick(){return filterReviews(3);},children:/*#__PURE__*/_jsx(Stars,{rating:3.0})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",style:{cursor:'pointer'},onClick:function onClick(){return filterReviews(2);},children:/*#__PURE__*/_jsx(Stars,{rating:2.0})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",style:{cursor:'pointer'},onClick:function onClick(){return filterReviews(1);},children:/*#__PURE__*/_jsx(Stars,{rating:1.0})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Leave a Review:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-3\",children:\"Share your thoughts with other customers\"}),getLeaveReviewComponent()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-7 offset-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-5\",children:\"Customer Reviews\"}),/*#__PURE__*/_jsx(Reviews,{reviews:reviews})]})]})})]});};var mapStateToProps=function mapStateToProps(state){return{product:state.products.product,related_products:state.products.related_products,wishlist:state.wishlist.items,isAuthenticated:state.auth.isAuthenticated,review:state.reviews.review,reviews:state.reviews.reviews};};export default connect(mapStateToProps,{get_product:get_product,get_related_products:get_related_products,add_item:add_item,get_items:get_items,get_total:get_total,get_item_total:get_item_total,get_wishlist_items:get_wishlist_items,get_wishlist_item_total:get_wishlist_item_total,add_wishlist_item:add_wishlist_item,remove_wishlist_item:remove_wishlist_item,get_reviews:get_reviews,get_review:get_review,create_review:create_review,update_review:update_review,delete_review:delete_review,filter_reviews:filter_reviews})(ProductDetail);","map":{"version":3,"sources":["/Users/dmuino/shop_time/src/containers/ProductDetail.js"],"names":["React","useState","useEffect","Redirect","connect","get_product","get_related_products","add_item","get_items","get_total","get_item_total","get_wishlist_items","get_wishlist_item_total","add_wishlist_item","remove_wishlist_item","get_reviews","get_review","create_review","update_review","delete_review","filter_reviews","Card","ProductDetailCard","LeaveReview","Reviews","Stars","ProductDetail","match","product","related_products","wishlist","isAuthenticated","review","reviews","loginRedirect","setLoginRedirect","redirect","setRedirect","comment","formData","setFormData","rating","setRating","undefined","window","scrollTo","productId","params","id","onChange","e","target","name","value","requireLogin","preventDefault","leaveReview","updateReview","deleteReview","fetchData","filterReviews","numStars","getReviews","getRelatedProducts","length","map","index","getLeaveReviewComponent","Object","keys","cursor","mapStateToProps","state","products","items","auth"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { \n    get_product, \n    get_related_products \n} from '../actions/products';\nimport {\n    add_item,\n    get_items,\n    get_total,\n    get_item_total\n} from '../actions/cart';\nimport {\n    get_wishlist_items,\n    get_wishlist_item_total,\n    add_wishlist_item,\n    remove_wishlist_item,\n} from '../actions/wishlist';\nimport {\n    get_reviews,\n    get_review,\n    create_review,\n    update_review,\n    delete_review,\n    filter_reviews\n} from '../actions/reviews';\nimport Card from '../components/Card';\nimport ProductDetailCard from '../components/ProductDetailCard';\nimport LeaveReview from '../components/LeaveReview';\nimport Reviews from '../components/Reviews';\nimport Stars from '../components/Stars';\n\nconst ProductDetail = ({ \n    match, \n    product, \n    get_product,\n    related_products,\n    get_related_products,\n    add_item,\n    get_items,\n    get_total,\n    get_item_total,\n    wishlist,\n    get_wishlist_items,\n    get_wishlist_item_total,\n    add_wishlist_item,\n    remove_wishlist_item,\n    isAuthenticated,\n    review,\n    reviews,\n    get_reviews,\n    get_review,\n    create_review,\n    update_review,\n    delete_review,\n    filter_reviews\n}) => {\n    const [loginRedirect, setLoginRedirect] = useState(false);\n    const [redirect, setRedirect] = useState(false);\n\n    const [formData, setFormData] = useState({\n        comment: ''\n    });\n    const [rating, setRating] = useState(5.0);\n\n    const { comment } = formData;\n\n    useEffect(() => {\n        if (\n            isAuthenticated !== null &&\n            isAuthenticated !== undefined\n        ) {\n            if (\n                isAuthenticated &&\n                review &&\n                review !== null &&\n                review !== undefined &&\n                review.comment &&\n                review.comment !== null &&\n                review.comment !== undefined\n            ) {\n                setFormData({\n                    comment: review.comment\n                });\n            } else {\n                setFormData({\n                    comment: ''\n                });\n            }\n        }\n    }, [review, isAuthenticated]);\n\n    useEffect(() => {\n        window.scrollTo(0, 0);\n        const productId = match.params.id;\n\n        get_product(productId);\n        get_related_products(productId);\n    }, [match.params.id]);\n\n    useEffect(() => {\n        const productId = match.params.id;\n\n        get_reviews(productId);\n    }, [match.params.id]);\n\n    useEffect(() => {\n        const productId = match.params.id;\n\n        get_review(productId);\n    }, [match.params.id, isAuthenticated]);\n\n    const onChange = e => setFormData({ ...formData, [e.target.name]: e.target.value });\n\n    const requireLogin = e => {\n        e.preventDefault();\n\n        setLoginRedirect(true);\n    }\n\n    const leaveReview = e => {\n        e.preventDefault();\n\n        const productId = match.params.id;\n\n        if (rating !== null)\n            create_review(productId, rating, comment);\n    };\n\n    const updateReview = e => {\n        e.preventDefault();\n\n        const productId = match.params.id;\n\n        if (rating !== null)\n            update_review(productId, rating, comment);\n    };\n\n    const deleteReview = () => {\n        const productId = match.params.id;\n\n        const fetchData = async () => {\n            await delete_review(productId);\n            await get_review(productId);\n            setRating(5.0);\n            setFormData({\n                comment: ''\n            });\n        };\n\n        fetchData();\n    };\n\n    const filterReviews = numStars => {\n        const productId = match.params.id;\n\n        filter_reviews(productId, numStars);\n    };\n\n    const getReviews = () => {\n        const productId = match.params.id;\n\n        get_reviews(productId);\n    };\n\n    const getRelatedProducts = () => {\n        if (\n            related_products &&\n            related_products !== null && \n            related_products !== undefined &&\n            related_products.length !== 0\n        ) {\n            return related_products.map((product, index) => (\n                <div key={index} className='col-4'>\n                    <Card\n                        product={product}\n                        add_item={add_item}\n                        get_items={get_items}\n                        get_total={get_total}\n                        get_item_total={get_item_total}\n                        wishlist={wishlist}\n                        get_wishlist_items={get_wishlist_items}\n                        get_wishlist_item_total={get_wishlist_item_total}\n                        add_wishlist_item={add_wishlist_item}\n                        remove_wishlist_item={remove_wishlist_item}\n                        isAuthenticated={isAuthenticated}\n                        setLoginRedirect={setLoginRedirect}\n                        setRedirect={setRedirect}\n                    />\n                </div>\n            ))\n        }\n    };\n\n    const getLeaveReviewComponent = () => {\n        if (isAuthenticated) {\n            if (\n                review &&\n                review !== null &&\n                review !== undefined &&\n                Object.keys(review).length === 0\n            ) {\n                return (\n                    <LeaveReview\n                        review={review}\n                        rating={rating}\n                        setRating={setRating}\n                        onSubmit={leaveReview}\n                        onChange={onChange}\n                        comment={comment}\n                    />\n                );\n            }\n            else if (\n                review &&\n                review !== null &&\n                review !== undefined &&\n                Object.keys(review).length !== 0\n            ) {\n                return (\n                    <LeaveReview\n                        review={review}\n                        rating={rating}\n                        setRating={setRating}\n                        onSubmit={updateReview}\n                        onChange={onChange}\n                        comment={comment}\n                        deleteReview={deleteReview}\n                    />\n                );\n            }\n        } else {\n            return (\n                <button\n                    className='btn btn-warning'\n                    onClick={requireLogin}\n                >\n                    Login to Leave a Review\n                </button>\n            );\n        }\n    };\n\n    if (loginRedirect)\n        return <Redirect to='/login' />;\n    if (redirect)\n        return <Redirect to='/cart-or-continue-shopping' />;\n\n    return (\n        <div className='container mt-5'>\n            <ProductDetailCard\n                product={product}\n                add_item={add_item}\n                get_items={get_items}\n                get_total={get_total}\n                get_item_total={get_item_total}\n                setRedirect={setRedirect}\n                isAuthenticated={isAuthenticated}\n                setLoginRedirect={setLoginRedirect}\n                add_wishlist_item={add_wishlist_item}\n                get_wishlist_items={get_wishlist_items}\n                get_wishlist_item_total={get_wishlist_item_total}\n            />\n\n            <hr />\n\n            <section className='mt-5'>\n                <h2 className='mt-5'>Related Products:</h2>\n                <div className='row mt-5 ml-5 mr-5'>\n                    {getRelatedProducts()}\n                </div>\n            </section>\n\n            <section className='mt-5 mb-5'>\n                <div className='row'>\n                    <div className='col-3'>\n                        <h2 className='mb-3'>Filter Reviews</h2>\n                        <button\n                            className='btn btn-primary btn-sm mb-3'\n                            onClick={getReviews}\n                        >\n                            All\n                        </button>\n                        <div\n                            className='mb-1'\n                            style={{ cursor: 'pointer' }}\n                            onClick={() => filterReviews(5)}\n                        >\n                            <Stars rating={5.0} />\n                        </div>\n                        <div\n                            className='mb-1'\n                            style={{ cursor: 'pointer' }}\n                            onClick={() => filterReviews(4)}\n                        >\n                            <Stars rating={4.0} />\n                        </div>\n                        <div\n                            className='mb-1'\n                            style={{ cursor: 'pointer' }}\n                            onClick={() => filterReviews(3)}\n                        >\n                            <Stars rating={3.0} />\n                        </div>\n                        <div\n                            className='mb-1'\n                            style={{ cursor: 'pointer' }}\n                            onClick={() => filterReviews(2)}\n                        >\n                            <Stars rating={2.0} />\n                        </div>\n                        <div\n                            className='mb-3'\n                            style={{ cursor: 'pointer' }}\n                            onClick={() => filterReviews(1)}\n                        >\n                            <Stars rating={1.0} />\n                        </div>\n\n                        <h2>Leave a Review:</h2>\n                        <p className='mb-3'>\n                            Share your thoughts with other customers\n                        </p>\n                        {getLeaveReviewComponent()}\n                    </div>\n                    <div className='col-7 offset-2'>\n                        <h2 className='mb-5'>Customer Reviews</h2>\n                        <Reviews reviews={reviews} />\n                    </div>\n                </div>\n            </section>\n        </div>\n    )\n};\n\nconst mapStateToProps = state => ({\n    product: state.products.product,\n    related_products: state.products.related_products,\n    wishlist: state.wishlist.items,\n    isAuthenticated: state.auth.isAuthenticated,\n    review: state.reviews.review,\n    reviews: state.reviews.reviews\n});\n\nexport default connect(mapStateToProps, {\n    get_product,\n    get_related_products,\n    add_item,\n    get_items,\n    get_total,\n    get_item_total,\n    get_wishlist_items,\n    get_wishlist_item_total,\n    add_wishlist_item,\n    remove_wishlist_item,\n    get_reviews,\n    get_review,\n    create_review,\n    update_review,\n    delete_review,\n    filter_reviews\n})(ProductDetail);\n"]},"metadata":{},"sourceType":"module"}