{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dmuino/shop_time/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{setAlert}from'./alert';import{GET_COUPON_SUCCESS,GET_COUPON_FAIL}from'./types';export var check_coupon=function check_coupon(coupon_name){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={headers:{'Accept':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access'))}};_context.prev=1;_context.next=4;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/coupon/check-coupon?coupon_name=\").concat(coupon_name),config);case 4:res=_context.sent;if(res.status===200){dispatch({type:GET_COUPON_SUCCESS,payload:res.data});dispatch(setAlert('Coupon applied','success'));}else{dispatch({type:GET_COUPON_FAIL});if(res.data.error){dispatch(setAlert(res.data.error,'danger'));}else{dispatch(setAlert('This coupon does not exist','danger'));}}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:GET_COUPON_FAIL});dispatch(setAlert('This coupon does not exist','danger'));case 12:window.scrollTo(0,0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/dmuino/shop_time/src/actions/coupons.js"],"names":["axios","setAlert","GET_COUPON_SUCCESS","GET_COUPON_FAIL","check_coupon","coupon_name","dispatch","config","headers","localStorage","getItem","get","process","env","REACT_APP_API_URL","res","status","type","payload","data","error","window","scrollTo"],"mappings":"yRAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,SAAzB,CACA,OACIC,kBADJ,CAEIC,eAFJ,KAGO,SAHP,CAKA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,WAAW,iGAAI,iBAAMC,QAAN,iIACjCC,MADiC,CACxB,CACXC,OAAO,CAAE,CACL,SAAU,kBADL,CAEL,8BAAwBC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAxB,CAFK,CADE,CADwB,uCASjBV,CAAAA,KAAK,CAACW,GAAN,WAAaC,OAAO,CAACC,GAAR,CAAYC,iBAAzB,iDAAkFT,WAAlF,EAAiGE,MAAjG,CATiB,QAS7BQ,GAT6B,eAWnC,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACpBV,QAAQ,CAAC,CACLW,IAAI,CAAEf,kBADD,CAELgB,OAAO,CAAEH,GAAG,CAACI,IAFR,CAAD,CAAR,CAIAb,QAAQ,CAACL,QAAQ,CAAC,gBAAD,CAAmB,SAAnB,CAAT,CAAR,CACH,CAND,IAMO,CACHK,QAAQ,CAAC,CACLW,IAAI,CAAEd,eADD,CAAD,CAAR,CAGA,GAAIY,GAAG,CAACI,IAAJ,CAASC,KAAb,CAAoB,CAChBd,QAAQ,CAACL,QAAQ,CAACc,GAAG,CAACI,IAAJ,CAASC,KAAV,CAAiB,QAAjB,CAAT,CAAR,CACH,CAFD,IAEO,CACHd,QAAQ,CAACL,QAAQ,CAAC,4BAAD,CAA+B,QAA/B,CAAT,CAAR,CACH,CACJ,CA1BkC,+EA4BnCK,QAAQ,CAAC,CACLW,IAAI,CAAEd,eADD,CAAD,CAAR,CAGAG,QAAQ,CAACL,QAAQ,CAAC,4BAAD,CAA+B,QAA/B,CAAT,CAAR,CA/BmC,QAkCvCoB,MAAM,CAACC,QAAP,CAAgB,CAAhB,CAAmB,CAAnB,EAlCuC,oEAAJ,gEAAhC","sourcesContent":["import axios from 'axios';\nimport { setAlert } from './alert';\nimport {\n    GET_COUPON_SUCCESS,\n    GET_COUPON_FAIL,\n} from './types';\n\nexport const check_coupon = coupon_name => async dispatch => {\n    const config = {\n        headers: {\n            'Accept': 'application/json',\n            'Authorization': `JWT ${localStorage.getItem('access')}`\n        }\n    };\n\n    try {\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/coupon/check-coupon?coupon_name=${coupon_name}`, config);\n\n        if (res.status === 200) {\n            dispatch({\n                type: GET_COUPON_SUCCESS,\n                payload: res.data\n            });\n            dispatch(setAlert('Coupon applied', 'success'));\n        } else {\n            dispatch({\n                type: GET_COUPON_FAIL\n            });\n            if (res.data.error) {\n                dispatch(setAlert(res.data.error, 'danger'));\n            } else {\n                dispatch(setAlert('This coupon does not exist', 'danger'));\n            }\n        }\n    } catch(err) {\n        dispatch({\n            type: GET_COUPON_FAIL\n        });\n        dispatch(setAlert('This coupon does not exist', 'danger'));\n    }\n\n    window.scrollTo(0, 0);\n};\n"]},"metadata":{},"sourceType":"module"}